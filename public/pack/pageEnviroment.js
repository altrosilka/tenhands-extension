!function(){function e(){var e;return e=document.querySelector('meta[property="og:image"]'),null!==e?e.getAttribute("content"):(e=document.querySelector('link[rel="image_src"]'),null!==e?e.getAttribute("href"):(e=document.querySelector('meta[name="twitter:image"]'),null!==e?e.getAttribute("content"):e))}function t(e){var t;return t=document.querySelector(e),null!==t?t.innerHTML.replace(/(<([^>]+)>)/gi,"").replace(/(\n)+/g,"\n"):void 0}function n(){var e;return e=document.querySelector('meta[name="description"]'),null!==e?e.getAttribute("content"):(e=document.querySelector('meta[name="Description"]'),null!==e?e.getAttribute("content"):"")}function i(){r=document.getElementById("smm-transport-ekniERgebe39EWee"),null===r?(console.log("not "),setTimeout(i,300)):setTimeout(function(){r.contentWindow.postMessage(u,"chrome-extension://"+chrome.runtime.id)},500)}for(var r,o,l,a=document.getElementsByTagName("img"),d=[],s=0,c=a.length;c>s;s++)o=a.item(s),o.hidden||o.naturalHeight<100||o.naturalWidth<100||o.width<150||o.height<150||(l=o.width/o.height,l>4||.25>l||d.push({alt:o.alt,clientHeight:o.clientHeight,clientWidth:o.clientWidth,width:o.width,height:o.height,title:o.title,src:o.src,src_big:o.src,type:"image"}));var u={images:d,title:document.title,description:n(),url:document.location.href,imageSrc:e(),h1:t("h1"),h2:t("h2"),h3:t("h3")},m=window.getSelection();if(m&&"None"!==m.type){var g=m.getRangeAt(0);if(g){var h=document.createElement("div");h.appendChild(g.cloneContents()),u.selection=h.innerHTML}}console.log(JSON.stringify(u)),i()}(),function(e,t){function n(e){var n=e.message?"message":"data",i=e[n];if(console.log(1),i===a("close")&&(l(),setTimeout(function(){t.body.removeChild(m)},450)),i===a("toggle")){var r=m.getAttribute("data-small-view");null===r?(m.setAttribute("data-small-view","true"),m.style["-webkit-transform"]="translateY(50%)"):(m.removeAttribute("data-small-view"),m.style["-webkit-transform"]="translateY(0)")}}function i(e,n){var i=t.createElement("div");return i.innerHTML=n,i.setAttribute("style","background-color: #EEE; display: inline-block; margin: 0 5px; padding: 3px 6px; border: 1px solid #AAA; cursor: pointer;"),i.addEventListener("click",function(){}),i}function r(e,t){return{x:e.clientX>t.clientX?1:-1,y:e.clientY>t.clientY?1:-1}}function o(){m.style.display="block",setTimeout(function(){m.style.transform="translateY(0px)",m.style.opacity="1",m.style.visibility="visible"},0)}function l(){m.style.transform="translateY(100px)",m.style.opacity="0",m.style.visibility="hidden",window.removeEventListener(A,n),t.body.removeChild(t.getElementById(s+"additionalPadding")),setTimeout(function(){m.style.display="none"},400)}function a(e){return c+e}var d,s="smm-UEe9vE-",c="Ejiw9494WvweejgreWCEGHeeE_FF_",u="smm-layout-ekniERgebe39EWee",m=t.getElementById(u);if(null===m){m=t.createElement("div"),m.setAttribute("id",u),m.setAttribute("class",s+"layout"),m.setAttribute("style","");var g=t.createElement("div");g.setAttribute("style","height:"+window.innerHeight/2+"px"),g.setAttribute("id",s+"additionalPadding"),t.body.appendChild(g);var h=t.createElement("iframe");h.src=chrome.extension.getURL("pages/createPost.html"),h.setAttribute("style","width:100%;height:100%;z-index:1;position:relative;"),h.setAttribute("id","smm-transport-ekniERgebe39EWee"),h.setAttribute("frameborder","0"),m.appendChild(h),t.body.appendChild(m);var p=t.createElement("div");p.setAttribute("style","position:fixed; z-index: 99999999999898988899;margin:10px;");var v=i("addParagraph","Новый параграф"),y=i("addString","Новая строка"),b=i("addInstead","Вместо текста"),f=i("addTo","Добавить к тексту");p.appendChild(v),p.appendChild(y),p.appendChild(b),p.appendChild(f),m.appendChild(p),document.body.addEventListener("mousedown",function(e){d=e}),document.body.addEventListener("mouseup",function(e){var t=window.getSelection();if(t&&"None"!==t.type){var n=t.getRangeAt(0);if(n){var i=document.createElement("div");i.appendChild(n.cloneContents());var o=i.innerHTML;if(o&&""!==o){r(e,d),window.innerWidth,window.innerHeight}}}e.clientX===d.clientX&&e.clientY===d.clientY&&(p.style.left="-9999px")})}else"hidden"===e.getComputedStyle(m).visibility&&o();var w=window.addEventListener?"addEventListener":"attachEvent",E=window[w],A="attachEvent"==w?"onmessage":"message";E(A,n,!1)}(window,document);